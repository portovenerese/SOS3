<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Associazione SOS METAL DETECTOR NAZIONALE Oggetti Smarriti</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.16/tailwind.min.css">
</head>
<body class="bg-gray-100">
  <header class="bg-blue-500 py-4 text-white">
    <div class="container mx-auto flex items-center justify-between">
      <div class="flex items-center">
        <img src="logo.png" alt="Logo" class="h-8 mr-4">
        <h1 class="text-2xl font-bold">Associazione SOS METAL DETECTOR NAZIONALE Oggetti Smarriti (R) ODV</h1>
      </div>
    </div>
  </header>

  <main class="container mx-auto my-8">
    <form id="lost-item-form" action="https://formspree.io/f/xyzgdwan" method="POST" class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
      <!-- Campi modulo -->
      <div class="mb-4">
        <label class="block text-gray-700 font-bold mb-2" for="name">Nome e cognome del richiedente:</label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="name" type="text" name="Richiedente" placeholder="Inserisci nome e cognome" required>
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 font-bold mb-2" for="phone">Numero di telefono dove poter essere contattati:</label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="phone" type="tel" name="Telefono" placeholder="Inserisci numero di telefono" required>
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 font-bold mb-2" for="lost-item">Oggetto smarrito:</label>
        <select class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="lost-item" name="Oggetto smarrito" required>
          <option value="">Seleziona l'oggetto smarrito</option>
          <option value="anello">Anello</option>
          <option value="braccialetto">Braccialetto</option>
          <option value="orecchino">Orecchino</option>
          <option value="orologio">Orologio</option>
          <option value="ciondolo">Ciondolo</option>
          <option value="chiavi">Chiavi</option>
          <option value="altro">Altro</option>
        </select>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mt-2 hidden" id="lost-item-other" name="Altro oggetto smarrito" type="text" placeholder="Inserisci l'oggetto smarrito">
      </div>

      <div class="mb-4 hidden" id="beach-type-container">
        <label class="block text-gray-700 font-bold mb-2" for="beach-type">Stabilimento balneare o spiaggia libera?</label>
        <select class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="beach-type" name="Stabilimento balneare o spiaggia libera?">
          <option value="">Seleziona</option>
          <option value="stabilimento">Stabilimento balneare</option>
          <option value="pubblica">Spiaggia pubblica</option>
        </select>
      </div>

      <div class="mb-4 hidden" id="water-depth-container">
        <label class="block text-gray-700 font-bold mb-2" for="water-depth">Profondità dell'acqua:</label>
        <select class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="water-depth" name="Profondità dell'acqua">
          <option value="">Seleziona</option>
          <option value="bagnasciuga">Acqua bassa (bagnasciuga)</option>
          <option value="metroemezzo">Acqua fino ad un metro e mezzo</option>
          <option value="profonda">Acqua profonda</option>
        </select>
      </div>

      <div class="mb-4 hidden" id="seabed-type-container">
        <label class="block text-gray-700 font-bold mb-2" for="seabed-type">Tipologia di fondale:</label>
        <select class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="seabed-type" name="Tipologia di fondale">
          <option value="">Seleziona</option>
          <option value="sabbia">Sabbia</option>
          <option value="ghiaia">Ghiaia</option>
          <option value="sabbiaeghiaia">Sabbia e ghiaia</option>
          <option value="sassi">Sassi grandi</option>
        </select>
      </div>

      <div class="mb-4 hidden" id="beach-sand-type-container">
        <label class="block text-gray-700 font-bold mb-2" for="beach-sand-type">Tipologia di spiaggia:</label>
        <select class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="beach-sand-type" name="Tipologia di spiaggia">
          <option value="">Seleziona</option>
          <option value="sabbia">Sabbia</option>
          <option value="ghiaia">Ghiaia</option>
          <option value="sabbiaeghiaia">Sabbia e ghiaia</option>
          <option value="sassi">Sassi grandi</option>
        </select>
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 font-bold mb-2" for="region">Regione:</label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="region" name="Regione" type="text" placeholder="Inserisci la regione">
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 font-bold mb-2" for="province">Provincia:</label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="province" name="Provincia" type="text" placeholder="Inserisci la provincia">
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 font-bold mb-2" for="city">Comune:</label>
        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="city" name="Città" type="text" placeholder="Inserisci il comune">
      </div>

      <div class="mb-4">
        <label class="block text-gray-700 font-bold mb-2" for="notes">Note:</label>
        <textarea class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="notes" name="Note" placeholder="Inserisci note aggiuntive"></textarea>
      </div>

      <div class="flex items-center justify-between">
        <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit" id="submit-button">
          Invia
        </button>
      </div>
    </form>
  </main>

  <script>
    const form = document.getElementById('lost-item-form');
    const lostItemSelect = document.getElementById('lost-item');
    const lostItemOtherInput = document.getElementById('lost-item-other');
    const locationSelect = document.getElementById('location');
    const locationOtherInput = document.getElementById('location-other');
    const beachTypeContainer = document.getElementById('beach-type-container');
    const beachTypeSelect = document.getElementById('beach-type');
    const waterDepthContainer = document.getElementById('water-depth-container');
    const waterDepthSelect = document.getElementById('water-depth');
    const seabedTypeContainer = document.getElementById('seabed-type-container');
    const seabedTypeSelect = document.getElementById('seabed-type');
    const beachSandTypeContainer = document.getElementById('beach-sand-type-container');
    const beachSandTypeSelect = document.getElementById('beach-sand-type');

    lostItemSelect.addEventListener('change', () => {
      lostItemOtherInput.classList.toggle('hidden', lostItemSelect.value !== 'altro');
      lostItemOtherInput.required = lostItemSelect.value === 'altro';
    });

    locationSelect.addEventListener('change', () => {
      locationOtherInput.classList.toggle('hidden', locationSelect.value !== 'altro');
      beachTypeContainer.classList.toggle('hidden', !['mare', 'spiaggia'].includes(locationSelect.value));
      waterDepthContainer.classList.toggle('hidden', locationSelect.value !== 'mare');
      seabedTypeContainer.classList.toggle('hidden', locationSelect.value !== 'mare');
      beachSandTypeContainer.classList.toggle('hidden', locationSelect.value !== 'spiaggia');
    });

    beachTypeSelect.addEventListener('change', () => {
      if (locationSelect.value === 'spiaggia') {
        beachSandTypeContainer.classList.remove('hidden');
      }
    });

    form.addEventListener('submit', function(e) {
      e.preventDefault();
      
      if (lostItemSelect.value === 'altro') {
        lostItemSelect.value = lostItemOtherInput.value;
      }

      // Creo un oggetto FormData con solo i campi compilati
      const formData = new FormData();
      for (const field of form.elements) {
        if (field.name && field.value) {
          formData.append(field.name, field.value);
        }
      }

      fetch(form.action, {
        method: form.method,
        body: formData,
        headers: {
          'Accept': 'application/json'
        }
      }).then(response => {
        if (response.ok) {
          alert('Dati inviati correttamente!');
          form.reset();
        } else {
          throw new Error('Errore nell\'invio dei dati');
        }
      }).catch(error => {
        alert('Si è verificato un errore nell\'invio dei dati. Riprova più tardi.');
        console.error('Errore:', error);
      });
    });
  </script>
</body>
</html>
